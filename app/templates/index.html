{% extends "base.html" %}

{% block content %}
<div class="row">
    <!-- Left Sidebar Navigation -->
    <div class="col-md-3 mb-4">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Workflow</h5>
            </div>
            <div class="list-group list-group-flush">
                <a href="#organization-section" class="list-group-item list-group-item-action">
                    <i class="fas fa-building"></i> Organization
                </a>
                <a href="#certification-section" class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-certificate"></i> Certifications
                </a>
                <a href="#document-section" class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-file-upload"></i> Documents
                </a>
                <a href="#chat-section" class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-comments"></i> Chat Assistant
                </a>
                <a href="#evaluation-section" class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-tasks"></i> Evaluation
                </a>
                <a href="#results-section" class="list-group-item list-group-item-action disabled">
                    <i class="fas fa-chart-bar"></i> Results
                </a>
            </div>
        </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="col-md-9">
        <!-- Organization Section -->
        <section id="organization-section" class="content-section">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-building me-2"></i>Organization Details</h5>
                </div>
                <div class="card-body">
                    <form id="organization-form">
                        <div class="mb-3">
                            <label for="org-name" class="form-label">Organization Name</label>
                            <input type="text" class="form-control" id="org-name" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="org-industry" class="form-label">Industry</label>
                                <select class="form-select" id="org-industry" required>
                                    <option value="" selected disabled>Select Industry</option>
                                    <option value="healthcare">Healthcare</option>
                                    <option value="finance">Finance & Banking</option>
                                    <option value="technology">Technology</option>
                                    <option value="retail">Retail</option>
                                    <option value="manufacturing">Manufacturing</option>
                                    <option value="education">Education</option>
                                    <option value="government">Government</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="org-size" class="form-label">Organization Size</label>
                                <select class="form-select" id="org-size" required>
                                    <option value="" selected disabled>Select Size</option>
                                    <option value="small">Small (1-50 employees)</option>
                                    <option value="medium">Medium (51-500 employees)</option>
                                    <option value="large">Large (501-5000 employees)</option>
                                    <option value="enterprise">Enterprise (5000+ employees)</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i>Save Organization Info
                        </button>
                    </form>
                </div>
            </div>
        </section>
        
        <!-- Certification Section -->
        <section id="certification-section" class="content-section d-none">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-certificate me-2"></i>Certification Selection</h5>
                </div>
                <div class="card-body">
                    <p class="mb-3">Select the certifications you're interested in pursuing:</p>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="iso27001" id="cert-iso27001">
                                        <label class="form-check-label fw-bold" for="cert-iso27001">
                                            ISO 27001
                                        </label>
                                    </div>
                                    <p class="small text-muted">Information Security Management System</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="soc2" id="cert-soc2">
                                        <label class="form-check-label fw-bold" for="cert-soc2">
                                            SOC 2
                                        </label>
                                    </div>
                                    <p class="small text-muted">Service Organization Control</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="hipaa" id="cert-hipaa">
                                        <label class="form-check-label fw-bold" for="cert-hipaa">
                                            HIPAA
                                        </label>
                                    </div>
                                    <p class="small text-muted">Health Insurance Portability and Accountability Act</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="gdpr" id="cert-gdpr">
                                        <label class="form-check-label fw-bold" for="cert-gdpr">
                                            GDPR
                                        </label>
                                    </div>
                                    <p class="small text-muted">General Data Protection Regulation</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="pci-dss" id="cert-pci-dss">
                                        <label class="form-check-label fw-bold" for="cert-pci-dss">
                                            PCI DSS
                                        </label>
                                    </div>
                                    <p class="small text-muted">Payment Card Industry Data Security Standard</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="ccpa" id="cert-ccpa">
                                        <label class="form-check-label fw-bold" for="cert-ccpa">
                                            CCPA
                                        </label>
                                    </div>
                                    <p class="small text-muted">California Consumer Privacy Act</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary" id="save-certifications">
                        <i class="fas fa-save me-2"></i>Save Selection
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Document Upload Section -->
        <section id="document-section" class="content-section d-none">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-file-upload me-2"></i>Document Upload</h5>
                </div>
                <div class="card-body">
                    <form id="document-upload-form">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="document-file" class="form-label">Select Document</label>
                                <input class="form-control" type="file" id="document-file" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="document-type" class="form-label">Document Type</label>
                                <select class="form-select" id="document-type" required>
                                    <option value="" selected disabled>Select Type</option>
                                    <option value="policy">Policy</option>
                                    <option value="procedure">Procedure</option>
                                    <option value="control">Control Documentation</option>
                                    <option value="assessment">Risk Assessment</option>
                                    <option value="report">Audit Report</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-upload me-2"></i>Upload Document
                        </button>
                    </form>
                    
                    <hr>
                    
                    <h6 class="mb-3">Uploaded Documents</h6>
                    <div class="table-responsive">
                        <table class="table table-hover" id="documents-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Size</th>
                                    <th>Uploaded</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="uploaded-documents">
                                <!-- Documents will be added here dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Chat Assistant Section -->
        <section id="chat-section" class="content-section d-none">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-comments me-2"></i>Chat Assistant</h5>
                </div>
                <div class="card-body">
                    <div id="chat-container" class="chat-container mb-3">
                        <div class="chat-message system-message">
                            <div class="message-content">Hello! I'm your certification assistant. How can I help you today?</div>
                            <small class="text-muted">{{ now }}</small>
                        </div>
                    </div>
                    <form id="chat-form">
                        <div class="input-group">
                            <input type="text" id="chat-input" class="form-control" placeholder="Type your message here..." required>
                            <button class="btn btn-primary" type="submit">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
        
        <!-- Evaluation Section -->
        <section id="evaluation-section" class="content-section d-none">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Certification Evaluation</h5>
                </div>
                <div class="card-body">
                    <p>Run an evaluation to assess your organization's readiness for the selected certifications based on your uploaded documents.</p>
                    
                    <form id="evaluation-form">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-play me-2"></i>Run Evaluation
                        </button>
                    </form>
                    
                    <div id="evaluation-progress" class="mt-4 d-none">
                        <h6>Evaluation Progress</h6>
                        <div class="progress">
                            <div id="evaluation-progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">0%</div>
                        </div>
                        <div id="evaluation-status" class="mt-2 small text-muted">
                            Initializing evaluation...
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Results Section -->
        <section id="results-section" class="content-section d-none">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Evaluation Results</h5>
                </div>
                <div class="card-body">
                    <div id="results-container">
                        <!-- Results will be added here dynamically -->
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Run an evaluation first to see results here.
                        </div>
                    </div>
                    
                    <hr>
                    
                    <h5 class="mb-3">Generate Compliance Documents</h5>
                    <form id="document-generation-form">
                        <div class="mb-3">
                            <p>Select the types of documents you want to generate:</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="gap-analysis" id="doc-gap-analysis" name="document-types">
                                        <label class="form-check-label" for="doc-gap-analysis">
                                            Gap Analysis Report
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="remediation-plan" id="doc-remediation-plan" name="document-types">
                                        <label class="form-check-label" for="doc-remediation-plan">
                                            Remediation Plan
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="policy-template" id="doc-policy-template" name="document-types">
                                        <label class="form-check-label" for="doc-policy-template">
                                            Policy Templates
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="procedure-template" id="doc-procedure-template" name="document-types">
                                        <label class="form-check-label" for="doc-procedure-template">
                                            Procedure Templates
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-file-alt me-2"></i>Generate Documents
                        </button>
                    </form>
                    
                    <hr>
                    
                    <h6 class="mb-3">Generated Documents</h6>
                    <div class="table-responsive">
                        <table class="table table-hover" id="generated-documents-table">
                            <thead>
                                <tr>
                                    <th>Document</th>
                                    <th>Type</th>
                                    <th>Generated</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="generated-documents">
                                <!-- Generated documents will be added here dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="content-section d-none">
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-cog me-2"></i>Settings</h5>
                </div>
                <div class="card-body">
                    <ul class="nav nav-tabs mb-4" id="settingsTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="models-tab" data-bs-toggle="tab" data-bs-target="#models-tab-pane" type="button" role="tab" aria-controls="models-tab-pane" aria-selected="true">
                                <i class="fas fa-robot me-2"></i>AI Models
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="account-tab" data-bs-toggle="tab" data-bs-target="#account-tab-pane" type="button" role="tab" aria-controls="account-tab-pane" aria-selected="false">
                                <i class="fas fa-user-circle me-2"></i>Account
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="integrations-tab" data-bs-toggle="tab" data-bs-target="#integrations-tab-pane" type="button" role="tab" aria-controls="integrations-tab-pane" aria-selected="false">
                                <i class="fas fa-plug me-2"></i>Integrations
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="appearance-tab" data-bs-toggle="tab" data-bs-target="#appearance-tab-pane" type="button" role="tab" aria-controls="appearance-tab-pane" aria-selected="false">
                                <i class="fas fa-palette me-2"></i>Appearance
                            </button>
                        </li>
                    </ul>
                    
                    <div class="tab-content" id="settingsTabContent">
                        <!-- AI Models Tab -->
                        <div class="tab-pane fade show active" id="models-tab-pane" role="tabpanel" aria-labelledby="models-tab" tabindex="0">
                            <h6 class="mb-3">AI Model Configuration</h6>
                            
                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="mb-0">Default Model</h6>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="enable-default-model" checked>
                                        <label class="form-check-label" for="enable-default-model">Enabled</label>
                                    </div>
                                </div>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="default-model-provider" class="form-label">Provider</label>
                                        <select class="form-select" id="default-model-provider">
                                            <option value="openai" selected>OpenAI</option>
                                            <option value="anthropic">Anthropic</option>
                                            <option value="google">Google Vertex AI</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="default-model-name" class="form-label">Model Name</label>
                                        <select class="form-select" id="default-model-name">
                                            <option value="gpt-4o" selected>GPT-4o</option>
                                            <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                        </select>
                                    </div>
                                    <div class="col-md-12">
                                        <label for="default-model-api-key" class="form-label">API Key</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="default-model-api-key" placeholder="Enter API key">
                                            <button class="btn btn-outline-secondary" type="button" id="toggle-api-key-visibility">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                        </div>
                                        <div class="form-text">Your API key is stored securely and never shared.</div>
                                    </div>
                                    <div class="col-md-12">
                                        <label for="default-model-endpoint" class="form-label">API Endpoint (Optional)</label>
                                        <input type="text" class="form-control" id="default-model-endpoint" placeholder="https://api.openai.com/v1/chat/completions">
                                        <div class="form-text">Leave blank to use the default endpoint for the selected provider.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="mb-0">Model Parameters</h6>
                                </div>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="model-temperature" class="form-label">Temperature: <span id="model-temperature-value">0.7</span></label>
                                        <input type="range" class="form-range" min="0" max="1" step="0.1" value="0.7" id="model-temperature">
                                        <div class="form-text">Controls randomness: lower values are more deterministic, higher values more creative.</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="model-max-tokens" class="form-label">Max Tokens</label>
                                        <input type="number" class="form-control" id="model-max-tokens" value="4000" min="100" max="8000">
                                        <div class="form-text">Maximum number of tokens to generate in the response.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="mb-0">Advanced Settings</h6>
                                    <button class="btn btn-sm btn-outline-primary" id="add-model-btn">
                                        <i class="fas fa-plus me-1"></i> Add Model
                                    </button>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table table-hover" id="models-table">
                                        <thead>
                                            <tr>
                                                <th>Provider</th>
                                                <th>Model</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>OpenAI</td>
                                                <td>GPT-4o</td>
                                                <td><span class="badge bg-success">Active</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary me-1" title="Edit">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-danger" title="Remove">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Anthropic</td>
                                                <td>Claude 3 Sonnet</td>
                                                <td><span class="badge bg-secondary">Inactive</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary me-1" title="Edit">
                                                        <i class="fas fa-edit"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-danger" title="Remove">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Account Tab -->
                        <div class="tab-pane fade" id="account-tab-pane" role="tabpanel" aria-labelledby="account-tab" tabindex="0">
                            <h6 class="mb-3">User Account Settings</h6>
                            
                            <div class="row g-3 mb-4">
                                <div class="col-md-6">
                                    <label for="user-name" class="form-label">Name</label>
                                    <input type="text" class="form-control" id="user-name" value="John Doe">
                                </div>
                                <div class="col-md-6">
                                    <label for="user-email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="user-email" value="john.doe@example.com">
                                </div>
                                <div class="col-12">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <label for="user-password" class="form-label">Password</label>
                                        <button class="btn btn-sm btn-link p-0" id="change-password-btn">Change Password</button>
                                    </div>
                                    <input type="password" class="form-control" id="user-password" value="********" disabled>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="mb-3">Notification Preferences</h6>
                            <div class="mb-4">
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="email-notifications" checked>
                                    <label class="form-check-label" for="email-notifications">Email Notifications</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="evaluation-notifications" checked>
                                    <label class="form-check-label" for="evaluation-notifications">Evaluation Completion Alerts</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="document-notifications" checked>
                                    <label class="form-check-label" for="document-notifications">Document Generation Alerts</label>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="mb-3">Data & Privacy</h6>
                            <div class="mb-4">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="data-analytics" checked>
                                    <label class="form-check-label" for="data-analytics">
                                        Share anonymous usage data to help improve GenCertify
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="data-retention">
                                    <label class="form-check-label" for="data-retention">
                                        Delete my data after 30 days of inactivity
                                    </label>
                                </div>
                                <button class="btn btn-outline-danger mt-2" id="delete-account-btn">
                                    <i class="fas fa-user-slash me-2"></i>Delete Account
                                </button>
                            </div>
                        </div>
                        
                        <!-- Integrations Tab -->
                        <div class="tab-pane fade" id="integrations-tab-pane" role="tabpanel" aria-labelledby="integrations-tab" tabindex="0">
                            <h6 class="mb-3">Connected Services</h6>
                            
                            <!-- Google Integration -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fab fa-google text-danger me-2"></i>Google Integration
                                        </h6>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="google-integration" checked>
                                            <label class="form-check-label" for="google-integration"></label>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <div class="card h-100 border-light">
                                                <div class="card-body">
                                                    <h6 class="card-title">
                                                        <i class="fas fa-file-alt text-primary me-2"></i>Google Docs
                                                    </h6>
                                                    <p class="card-text small text-muted">Import and export documents directly from Google Docs.</p>
                                                    <div class="form-check form-switch mb-2">
                                                        <input class="form-check-input" type="checkbox" id="google-docs-integration" checked>
                                                        <label class="form-check-label" for="google-docs-integration">Enable Docs Integration</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card h-100 border-light">
                                                <div class="card-body">
                                                    <h6 class="card-title">
                                                        <i class="fas fa-hdd text-primary me-2"></i>Google Drive
                                                    </h6>
                                                    <p class="card-text small text-muted">Store and retrieve documents from Google Drive.</p>
                                                    <div class="form-check form-switch mb-2">
                                                        <input class="form-check-input" type="checkbox" id="google-drive-integration" checked>
                                                        <label class="form-check-label" for="google-drive-integration">Enable Drive Integration</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="google-folder-id" class="form-label">Default Google Drive Folder</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="google-folder-id" placeholder="Folder ID or leave blank for root">
                                            <button class="btn btn-outline-secondary" type="button" id="browse-google-folders">
                                                <i class="fas fa-folder-open"></i> Browse
                                            </button>
                                        </div>
                                        <div class="form-text">Documents will be saved to this folder in Google Drive.</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Permissions</label>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="google-read-permission" checked>
                                            <label class="form-check-label" for="google-read-permission">
                                                Read files and folders
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="google-write-permission" checked>
                                            <label class="form-check-label" for="google-write-permission">
                                                Create and modify files
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <span class="badge bg-success me-2">Connected</span>
                                            <small class="text-muted">Connected as john.doe@example.com</small>
                                        </div>
                                        <div>
                                            <button class="btn btn-sm btn-outline-secondary me-2" id="configure-google">
                                                <i class="fas fa-cog me-1"></i> Configure
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger" id="disconnect-google">
                                                <i class="fas fa-unlink me-1"></i> Disconnect
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Microsoft 365 Integration -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fab fa-microsoft text-primary me-2"></i>Microsoft 365 Integration
                                        </h6>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="microsoft-integration">
                                            <label class="form-check-label" for="microsoft-integration"></label>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <div class="card h-100 border-light">
                                                <div class="card-body">
                                                    <h6 class="card-title">
                                                        <i class="fas fa-file-word text-primary me-2"></i>Office Documents
                                                    </h6>
                                                    <p class="card-text small text-muted">Import and export Word, Excel, and PowerPoint documents.</p>
                                                    <div class="form-check form-switch mb-2">
                                                        <input class="form-check-input" type="checkbox" id="ms-office-integration" disabled>
                                                        <label class="form-check-label" for="ms-office-integration">Enable Office Integration</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card h-100 border-light">
                                                <div class="card-body">
                                                    <h6 class="card-title">
                                                        <i class="fas fa-cloud text-primary me-2"></i>OneDrive
                                                    </h6>
                                                    <p class="card-text small text-muted">Store and retrieve documents from OneDrive.</p>
                                                    <div class="form-check form-switch mb-2">
                                                        <input class="form-check-input" type="checkbox" id="onedrive-integration" disabled>
                                                        <label class="form-check-label" for="onedrive-integration">Enable OneDrive Integration</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="ms-folder-path" class="form-label">Default OneDrive Folder</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="ms-folder-path" placeholder="Folder path or leave blank for root" disabled>
                                            <button class="btn btn-outline-secondary" type="button" id="browse-ms-folders" disabled>
                                                <i class="fas fa-folder-open"></i> Browse
                                            </button>
                                        </div>
                                        <div class="form-text">Documents will be saved to this folder in OneDrive.</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Permissions</label>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="ms-read-permission" disabled>
                                            <label class="form-check-label" for="ms-read-permission">
                                                Read files and folders
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="ms-write-permission" disabled>
                                            <label class="form-check-label" for="ms-write-permission">
                                                Create and modify files
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <span class="badge bg-secondary me-2">Not Connected</span>
                                        </div>
                                        <div>
                                            <button class="btn btn-sm btn-primary" id="connect-microsoft">
                                                <i class="fas fa-plug me-1"></i> Connect with Microsoft
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- GitHub Integration -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fab fa-github text-dark me-2"></i>GitHub Integration
                                        </h6>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="github-integration">
                                            <label class="form-check-label" for="github-integration"></label>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted mb-3">Connect to GitHub to store and version control your compliance documents.</p>
                                    
                                    <div class="mb-3">
                                        <label for="github-repo" class="form-label">Repository</label>
                                        <select class="form-select" id="github-repo" disabled>
                                            <option value="" selected disabled>Select a repository</option>
                                        </select>
                                        <div class="form-text">Select an existing repository or create a new one.</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="github-branch" class="form-label">Branch</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="github-branch" value="main" disabled>
                                            <button class="btn btn-outline-secondary" type="button" id="create-github-branch" disabled>
                                                <i class="fas fa-code-branch"></i> Create
                                            </button>
                                        </div>
                                        <div class="form-text">Branch to use for document storage.</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Permissions</label>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="github-repo-permission" disabled>
                                            <label class="form-check-label" for="github-repo-permission">
                                                Repository access (read/write)
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="github-workflow-permission" disabled>
                                            <label class="form-check-label" for="github-workflow-permission">
                                                Workflow access (for automated document generation)
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="github-auto-commit" disabled>
                                        <label class="form-check-label" for="github-auto-commit">
                                            Automatically commit changes when documents are generated
                                        </label>
                                    </div>
                                    
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <span class="badge bg-secondary me-2">Not Connected</span>
                                        </div>
                                        <div>
                                            <button class="btn btn-sm btn-dark" id="connect-github">
                                                <i class="fas fa-plug me-1"></i> Connect with GitHub
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="mb-3">API Access</h6>
                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <p class="mb-0">API Key</p>
                                        <p class="text-muted small">Use this key to access GenCertify API programmatically.</p>
                                    </div>
                                    <button class="btn btn-sm btn-outline-primary" id="generate-api-key">
                                        <i class="fas fa-key me-1"></i> Generate New Key
                                    </button>
                                </div>
                                
                                <div class="input-group mb-3">
                                    <input type="text" class="form-control" id="api-key" value="gct_sk_1a2b3c4d5e6f7g8h9i0j" readonly>
                                    <button class="btn btn-outline-secondary" type="button" id="copy-api-key">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                                
                                <div class="alert alert-warning">
                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                    Keep your API key secure. Do not share it publicly or commit it to version control.
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">API Scopes</label>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="api-read-scope" checked>
                                        <label class="form-check-label" for="api-read-scope">
                                            Read access (get documents, evaluations, results)
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="api-write-scope" checked>
                                        <label class="form-check-label" for="api-write-scope">
                                            Write access (create/update documents, run evaluations)
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="api-admin-scope">
                                        <label class="form-check-label" for="api-admin-scope">
                                            Admin access (manage users, settings)
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Appearance Tab -->
                        <div class="tab-pane fade" id="appearance-tab-pane" role="tabpanel" aria-labelledby="appearance-tab" tabindex="0">
                            <h6 class="mb-3">Theme Settings</h6>
                            
                            <div class="mb-4">
                                <label class="form-label">Theme Mode</label>
                                <div class="d-flex gap-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="theme-mode" id="theme-light" value="light" checked>
                                        <label class="form-check-label" for="theme-light">
                                            <i class="fas fa-sun me-1"></i> Light
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="theme-mode" id="theme-dark" value="dark">
                                        <label class="form-check-label" for="theme-dark">
                                            <i class="fas fa-moon me-1"></i> Dark
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="theme-mode" id="theme-system" value="system">
                                        <label class="form-check-label" for="theme-system">
                                            <i class="fas fa-desktop me-1"></i> System Default
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="mb-3">Display Settings</h6>
                            <div class="mb-4">
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="compact-view">
                                    <label class="form-check-label" for="compact-view">Compact View</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="show-tooltips" checked>
                                    <label class="form-check-label" for="show-tooltips">Show Tooltips</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="animations" checked>
                                    <label class="form-check-label" for="animations">Enable Animations</label>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="mb-3">Font Size</h6>
                            <div class="mb-4">
                                <div class="d-flex align-items-center">
                                    <span class="me-2"><i class="fas fa-font fa-sm"></i></span>
                                    <input type="range" class="form-range" min="0" max="4" step="1" value="2" id="font-size-range">
                                    <span class="ms-2"><i class="fas fa-font fa-lg"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-end mt-4">
                        <button type="button" class="btn btn-secondary me-2" id="reset-settings">Reset to Defaults</button>
                        <button type="button" class="btn btn-primary" id="save-all-settings">Save All Settings</button>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Handle navigation between sections
    const navLinks = document.querySelectorAll('#sidebar .nav-link');
    const contentSections = document.querySelectorAll('.content-section');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Get the target section ID from the data attribute
            const targetSectionId = this.getAttribute('data-section');
            
            // Hide all sections
            contentSections.forEach(section => {
                section.classList.add('d-none');
            });
            
            // Show the target section
            document.getElementById(targetSectionId).classList.remove('d-none');
            
            // Update active state in navigation
            navLinks.forEach(navLink => {
                navLink.classList.remove('active');
            });
            this.classList.add('active');
        });
    });
    
    // Handle chat form submission
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');
    
    chatForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const message = chatInput.value.trim();
        if (!message) return;
        
        // Get the active section
        const activeSection = Array.from(contentSections).find(section => !section.classList.contains('d-none'));
        const activeSectionId = activeSection ? activeSection.id : null;
        
        // TODO: Send message to backend with context of current section
        console.log(`Sending message: ${message} (Context: ${activeSectionId})`);
        
        // Clear input
        chatInput.value = '';
        
        // Add user message to chat (this would be handled by the actual chat implementation)
        // For now, just log to console
    });
    
    // Initialize with the first section active
    navLinks[0].click();
});

// Add settings-related JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Toggle API key visibility
    const toggleApiKeyBtn = document.getElementById('toggle-api-key-visibility');
    const apiKeyInput = document.getElementById('default-model-api-key');
    
    if (toggleApiKeyBtn && apiKeyInput) {
        toggleApiKeyBtn.addEventListener('click', function() {
            const icon = this.querySelector('i');
            if (apiKeyInput.type === 'password') {
                apiKeyInput.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                apiKeyInput.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
    }
    
    // Copy API key to clipboard
    const copyApiKeyBtn = document.getElementById('copy-api-key');
    const apiKeyDisplay = document.getElementById('api-key');
    
    if (copyApiKeyBtn && apiKeyDisplay) {
        copyApiKeyBtn.addEventListener('click', function() {
            apiKeyDisplay.select();
            document.execCommand('copy');
            showAlert('API key copied to clipboard!', 'success');
        });
    }
    
    // Model provider change handler
    const modelProviderSelect = document.getElementById('default-model-provider');
    const modelNameSelect = document.getElementById('default-model-name');
    
    if (modelProviderSelect && modelNameSelect) {
        modelProviderSelect.addEventListener('change', function() {
            const provider = this.value;
            modelNameSelect.innerHTML = '';
            
            if (provider === 'openai') {
                addOption(modelNameSelect, 'gpt-4o', 'GPT-4o');
                addOption(modelNameSelect, 'gpt-4-turbo', 'GPT-4 Turbo');
                addOption(modelNameSelect, 'gpt-3.5-turbo', 'GPT-3.5 Turbo');
            } else if (provider === 'anthropic') {
                addOption(modelNameSelect, 'claude-3-opus', 'Claude 3 Opus');
                addOption(modelNameSelect, 'claude-3-sonnet', 'Claude 3 Sonnet');
                addOption(modelNameSelect, 'claude-3-haiku', 'Claude 3 Haiku');
            } else if (provider === 'google') {
                addOption(modelNameSelect, 'gemini-pro', 'Gemini Pro');
                addOption(modelNameSelect, 'gemini-ultra', 'Gemini Ultra');
            }
        });
        
        function addOption(selectElement, value, text) {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = text;
            selectElement.appendChild(option);
        }
    }
    
    // Temperature range input
    const temperatureRange = document.getElementById('model-temperature');
    const temperatureValue = document.getElementById('model-temperature-value');
    
    if (temperatureRange && temperatureValue) {
        temperatureRange.addEventListener('input', function() {
            temperatureValue.textContent = this.value;
        });
    }
    
    // Save all settings
    const saveAllSettingsBtn = document.getElementById('save-all-settings');
    
    if (saveAllSettingsBtn) {
        saveAllSettingsBtn.addEventListener('click', function() {
            // Here you would collect all settings and save them
            // For now, just show a success message
            showAlert('All settings saved successfully!', 'success');
        });
    }
    
    // Reset settings
    const resetSettingsBtn = document.getElementById('reset-settings');
    
    if (resetSettingsBtn) {
        resetSettingsBtn.addEventListener('click', function() {
            if (confirm('Are you sure you want to reset all settings to their default values?')) {
                // Here you would reset all settings to defaults
                showAlert('Settings have been reset to defaults.', 'info');
            }
        });
    }
    
    // Theme mode selection
    const themeLightRadio = document.getElementById('theme-light');
    const themeDarkRadio = document.getElementById('theme-dark');
    const themeSystemRadio = document.getElementById('theme-system');
    const htmlElement = document.documentElement;
    
    if (themeLightRadio && themeDarkRadio && themeSystemRadio) {
        // Set initial state based on current theme
        const currentTheme = localStorage.getItem('theme');
        const prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (currentTheme === 'dark') {
            themeDarkRadio.checked = true;
        } else if (currentTheme === 'light') {
            themeLightRadio.checked = true;
        } else {
            themeSystemRadio.checked = true;
        }
        
        // Add event listeners
        themeLightRadio.addEventListener('change', function() {
            if (this.checked) {
                htmlElement.setAttribute('data-bs-theme', 'light');
                localStorage.setItem('theme', 'light');
                updateThemeIcon('light');
            }
        });
        
        themeDarkRadio.addEventListener('change', function() {
            if (this.checked) {
                htmlElement.setAttribute('data-bs-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                updateThemeIcon('dark');
            }
        });
        
        themeSystemRadio.addEventListener('change', function() {
            if (this.checked) {
                const systemTheme = prefersDarkMode ? 'dark' : 'light';
                htmlElement.setAttribute('data-bs-theme', systemTheme);
                localStorage.removeItem('theme');
                updateThemeIcon(systemTheme);
            }
        });
        
        function updateThemeIcon(theme) {
            const themeIcon = document.querySelector('#theme-toggle i');
            if (themeIcon) {
                if (theme === 'dark') {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                } else {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                }
            }
        }
    }
});
</script>
{% endblock %} 